<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>An√°lise Visual Super Sete</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        supersete: {
                            50: '#f7fee7',
                            100: '#ecfccb',
                            200: '#d9f99d',
                            300: '#bef264',
                            400: '#a3e635',
                            500: '#84cc16',
                            600: '#65a30d',
                            700: '#4d7c0f',
                            800: '#365314',
                            900: '#1a2e05',
                            primary: '#84cc16',
                            950: '#0f172a',
                            975: '#020617'
                        }
                    }
                }
            }
        }
    </script>
    <style>
        .number-ball {
            transition: all 0.2s ease;
        }
        .number-ball:hover {
            transform: scale(1.1);
        }
        .loading-spinner {
            border: 2px solid #f3f3f3;
            border-top: 2px solid #84cc16;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .responsive {
            width: 100% !important;
            height: auto !important;
            max-width: 400px;
            display: block;
            margin: 0 auto;
        }
        @media (max-width: 768px) {
            .responsive {
                max-width: 150px;
            }
        }
        @media (max-width: 480px) {
            .responsive {
                max-width: 120px;
            }
        }
        
        /* Destaque para colunas */
        .column-header {
            background: linear-gradient(135deg, #84cc16, #a3e635) !important;
            color: white !important;
            font-weight: bold !important;
        }
    </style>
</head>
<body class="bg-supersete-50 dark:bg-gray-900 min-h-screen">
    <!-- Header -->
    <header class="bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700">
        <div class="max-w-7xl mx-auto px-4 py-6 text-center">
            <div class="flex items-center justify-center gap-3 mb-2">
                <div class="flex items-center gap-2">
                    <img src="https://i.postimg.cc/wBthkvvc/supersete.png" alt="Super Sete" class="responsive">
                </div>
            </div>
            <div class="flex items-center justify-center gap-4">
                <h1 class="text-3xl font-bold text-gray-900 dark:text-white">
                    An√°lise Visual 
                    <span class="text-supersete-primary bg-gradient-to-r from-supersete-600 to-supersete-800 bg-clip-text text-transparent font-extrabold">SUPER SETE</span>
                </h1>
                <button id="helpBtn" class="bg-supersete-primary hover:bg-supersete-700 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold transition-colors">
                    ?
                </button>
            </div>
            <p class="text-gray-600 dark:text-gray-400 mt-2">An√°lise inteligente baseada em dados reais da API oficial da Caixa</p>
        </div>
    </header>

    <!-- Controls -->
    <div class="max-w-7xl mx-auto px-4 py-6">
        <div class="bg-gradient-to-r from-supersete-100 via-supersete-50 to-white dark:from-gray-800 dark:via-gray-700 dark:to-gray-800 rounded-lg shadow-sm p-6 mb-6 border border-supersete-200 dark:border-gray-600">
            <div class="flex flex-wrap items-center justify-center md:justify-start gap-4">
                <!-- Load Button -->
                <div class="bg-supersete-200 dark:bg-supersete-900 p-3 rounded-lg">
                    <button id="loadBtn" class="bg-supersete-primary hover:bg-supersete-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white px-6 py-2 rounded-lg transition-all duration-300 flex items-center gap-2 min-w-[200px] justify-center">
                        <div id="loadSpinner" class="loading-spinner hidden"></div>
                        <span id="loadText">Carregar Resultados</span>
                    </button>
                </div>

                <!-- View Type -->
                <div class="bg-supersete-100 dark:bg-supersete-950 p-3 rounded-lg flex items-center gap-2">
                    <label class="text-sm font-medium text-gray-700 dark:text-gray-300">Visualiza√ß√£o:</label>
                    <select id="viewType" class="border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                        <option value="columns">7 Colunas</option>
                        <option value="horizontal">Linha Horizontal</option>
                        <option value="compact">Compacto</option>
                        <option value="table">Tabela</option>
                    </select>
                </div>

                <!-- Sort Order -->
                <div class="bg-supersete-300 dark:bg-supersete-975 p-3 rounded-lg flex items-center gap-2">
                    <label class="text-sm font-medium text-gray-700 dark:text-gray-300">Ordem:</label>
                    <select id="sortOrder" class="border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                        <option value="desc">Mais Recente</option>
                        <option value="asc">Mais Antigo</option>
                    </select>
                </div>

                <!-- Columns -->
                <div class="bg-supersete-200 dark:bg-supersete-900 p-3 rounded-lg flex items-center gap-2">
                    <label class="text-sm font-medium text-gray-700 dark:text-gray-300">Cards:</label>
                    <select id="columns" class="border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                        <option value="1">1 Coluna</option>
                        <option value="2">2 Colunas</option>
                        <option value="3" selected>3 Colunas</option>
                        <option value="4">4 Colunas</option>
                        <option value="5">5 Colunas</option>
                    </select>
                </div>

                <!-- Show Info Toggle -->
                <div class="bg-supersete-100 dark:bg-supersete-950 p-3 rounded-lg">
                    <button id="showInfoBtn" class="flex items-center gap-2 cursor-pointer text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-supersete-primary">
                        <div class="w-5 h-5 bg-supersete-primary text-white rounded-full flex items-center justify-center text-xs font-bold">
                            <span id="toggleIcon">‚àí</span>
                        </div>
                        <span>Info Concursos</span>
                    </button>
                    <input type="checkbox" id="showInfo" checked class="hidden">
                </div>

                <!-- Limit -->
                <div class="bg-supersete-300 dark:bg-supersete-975 p-3 rounded-lg flex items-center gap-2">
                    <label class="text-sm font-medium text-gray-700 dark:text-gray-300">Carregar:</label>
                    <select id="limit" class="border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                        <option value="50">Do 1¬∫ ao 50¬∫ concurso</option>
                        <option value="100">Do 1¬∫ ao 100¬∫ concurso</option>
                        <option value="200">Do 1¬∫ ao 200¬∫ concurso</option>
                        <option value="500">Do 1¬∫ ao 500¬∫ concurso</option>
                        <option value="1000">Do 1¬∫ ao 1000¬∫ concurso</option>
                        <option value="metade">Do 1¬∫ at√© a metade</option>
                        <option value="todos">Do 1¬∫ ao √∫ltimo concurso</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Results Info -->
        <div id="resultsInfo" class="hidden bg-supersete-100 dark:bg-supersete-950 border border-supersete-300 dark:border-supersete-800 rounded-lg p-4 mb-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="bg-supersete-primary text-white px-3 py-1 rounded-full text-sm font-bold">
                        <span id="loadedCount">0</span> concursos
                    </div>
                    <span class="text-gray-700 dark:text-gray-300 text-sm">carregados com sucesso</span>
                </div>
                <button id="clearResults" class="text-gray-500 hover:text-red-500 text-sm underline">
                    Limpar resultados
                </button>
            </div>
        </div>

        <!-- Results -->
        <div id="results" class="grid gap-4"></div>

        <!-- Statistics -->
        <div id="statistics" class="hidden mt-4 bg-gray-50 dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700">
            <div class="flex items-center justify-between mb-3">
                <h4 class="text-sm font-medium text-gray-700 dark:text-gray-300">Estat√≠sticas por Coluna</h4>
                <span class="text-xs text-gray-500 dark:text-gray-400" id="tendency">7 Colunas</span>
            </div>
            <div class="overflow-x-auto">
                <table class="w-full text-xs">
                    <thead>
                        <tr class="border-b border-gray-200 dark:border-gray-600">
                            <th class="text-left py-1 text-gray-600 dark:text-gray-400">Coluna</th>
                            <th class="text-center py-1 text-gray-600 dark:text-gray-400">Mais Freq</th>
                            <th class="text-center py-1 text-gray-600 dark:text-gray-400">Vezes</th>
                            <th class="text-center py-1 text-gray-600 dark:text-gray-400">%</th>
                        </tr>
                    </thead>
                    <tbody class="text-gray-700 dark:text-gray-300" id="columnStats">
                        <!-- Estat√≠sticas das colunas ser√£o inseridas aqui -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Error -->
        <div id="error" class="hidden bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-700 dark:text-red-400 px-4 py-3 rounded-lg mt-4"></div>
    </div>

    <!-- Help Modal -->
    <div id="helpModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
            <!-- Modal Header -->
            <div class="bg-gradient-to-r from-supersete-primary to-supersete-700 text-white p-6 rounded-t-lg">
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center">
                            <span class="text-supersete-primary font-bold text-sm">S7</span>
                        </div>
                        <h2 class="text-xl font-bold">Como usar a An√°lise Visual Super Sete</h2>
                    </div>
                    <button id="closeModal" class="text-white hover:text-gray-300 text-2xl font-bold">√ó</button>
                </div>
            </div>

            <!-- Modal Content -->
            <div class="p-6 space-y-6">
                <section>
                    <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-3">Sobre o Super Sete</h3>
                    <p class="text-gray-700 dark:text-gray-300 leading-relaxed">
                        O Super Sete possui 7 colunas, cada uma com n√∫meros de 0 a 9. 
                        S√£o sorteados 7 n√∫meros, um para cada coluna. Esta ferramenta utiliza a API oficial da Caixa 
                        para exibir os resultados hist√≥ricos com diferentes formatos de visualiza√ß√£o e estat√≠sticas detalhadas.
                    </p>
                </section>

                <section>
                    <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-3">Como Interpretar</h3>
                    <div class="space-y-3">
                        <div class="flex items-start gap-3">
                            <div class="w-4 h-4 bg-supersete-primary rounded-full mt-1"></div>
                            <div>
                                <span class="font-medium text-gray-900 dark:text-white">N√∫meros Verdes:</span>
                                <span class="text-gray-700 dark:text-gray-300"> Foram sorteados na respectiva coluna</span>
                            </div>
                        </div>
                        <div class="flex items-start gap-3">
                            <div class="w-4 h-4 bg-gray-300 rounded-full mt-1"></div>
                            <div>
                                <span class="font-medium text-gray-900 dark:text-white">N√∫meros Cinza:</span>
                                <span class="text-gray-700 dark:text-gray-300"> N√£o foram sorteados na coluna</span>
                            </div>
                        </div>
                        <div class="flex items-start gap-3">
                            <div class="w-4 h-4 bg-blue-500 rounded-full mt-1"></div>
                            <div>
                                <span class="font-medium text-gray-900 dark:text-white">Cabe√ßalhos Azuis:</span>
                                <span class="text-gray-700 dark:text-gray-300"> Identificam cada uma das 7 colunas</span>
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Modal Footer -->
            <div class="bg-gray-50 dark:bg-gray-700 px-6 py-4 rounded-b-lg">
                <div class="flex justify-between items-center">
                    <p class="text-sm text-gray-600 dark:text-gray-400">
                        Jogue com responsabilidade. Esta ferramenta √© apenas para an√°lise estat√≠stica.
                    </p>
                    <button id="closeModalFooter" class="bg-supersete-primary hover:bg-supersete-700 text-white px-4 py-2 rounded-lg text-sm transition-colors">
                        Entendi
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        console.log('üöÄ Script Super Sete iniciado');

        // Dark mode detection
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        let allResults = [];
        let columnStats = {};
        let isLoading = false;

        function generateSampleData(limit, startFrom = 1) {
            console.log(`üé≤ Gerando ${limit} concursos do Super Sete...`);
            const sampleData = [];
            const startDate = new Date('2018-10-01'); // Data aproximada do in√≠cio do Super Sete
            
            for (let i = 0; i < limit; i++) {
                const concursoNumber = startFrom + i;
                const date = new Date(startDate);
                date.setDate(date.getDate() + (i * 3)); // Aproximadamente 2-3 sorteios por semana
                
                // Gera 7 n√∫meros aleat√≥rios (0-9) para as 7 colunas
                const dezenas = [];
                for (let col = 0; col < 7; col++) {
                    const num = Math.floor(Math.random() * 10); // 0 a 9
                    dezenas.push(num.toString());
                }
                
                sampleData.push({
                    numero: concursoNumber,
                    dataApuracao: date.toLocaleDateString('pt-BR'),
                    listaDezenas: dezenas
                });
            }
            
            console.log(`‚úÖ Gerados ${sampleData.length} concursos do Super Sete: ${sampleData[0]?.numero} at√© ${sampleData[sampleData.length-1]?.numero}`);
            return sampleData;
        }

        function calculateColumnStats() {
            columnStats = {};
            
            // Inicializa contadores para cada coluna (0-6) e cada n√∫mero (0-9)
            for (let col = 0; col < 7; col++) {
                columnStats[col] = {};
                for (let num = 0; num <= 9; num++) {
                    columnStats[col][num] = 0;
                }
            }
            
            // Conta frequ√™ncia de cada n√∫mero em cada coluna
            allResults.forEach(result => {
                if (result.listaDezenas && Array.isArray(result.listaDezenas)) {
                    result.listaDezenas.forEach((dezena, colIndex) => {
                        const num = parseInt(dezena);
                        if (colIndex < 7 && num >= 0 && num <= 9) {
                            columnStats[colIndex][num]++;
                        }
                    });
                }
            });
            
            console.log('üìä Estat√≠sticas de colunas calculadas:', columnStats);
        }

        async function loadResults() {
            console.log('üîÑ loadResults chamado para Super Sete');
            
            if (isLoading) {
                console.log('‚ö†Ô∏è J√° est√° carregando, ignorando');
                return;
            }
            
            isLoading = true;
            
            // Elementos do bot√£o
            const loadSpinner = document.getElementById('loadSpinner');
            const loadText = document.getElementById('loadText');
            const loadBtn = document.getElementById('loadBtn');
            
            if (loadSpinner) loadSpinner.classList.remove('hidden');
            if (loadBtn) loadBtn.disabled = true;
            
            // Determina quantos concursos carregar
            const limitSelect = document.getElementById('limit');
            const limitValue = limitSelect ? limitSelect.value : '50';
            
            let limit = 50;
            switch(limitValue) {
                case 'todos':
                    limit = 800; // Super Sete tem menos concursos
                    break;
                case 'metade':
                    limit = 400;
                    break;
                case '50':
                case '100':
                case '200':
                case '500':
                case '1000':
                    limit = parseInt(limitValue);
                    break;
            }
            
            // Limpa resultados anteriores
            allResults = [];
            columnStats = {};
            const resultsDiv = document.getElementById('results');
            if (resultsDiv) resultsDiv.innerHTML = '';
            
            try {
                console.log(`üéØ Carregando ${limit} concursos do Super Sete`);
                
                // TENTA BUSCAR DA API REAL PRIMEIRO
                if (loadText) loadText.textContent = 'Conectando √† API...';
                
                try {
                    const latestResponse = await fetch('https://servicebus2.caixa.gov.br/portaldeloterias/api/supersete');
                    
                    if (latestResponse.ok) {
                        const latestData = await latestResponse.json();
                        const ultimoConcurso = latestData.numero;
                        console.log(`‚úÖ API Super Sete conectada! √öltimo concurso: ${ultimoConcurso}`);
                        
                        // Ajusta limite baseado na API
                        let concursoFinal = Math.min(limit, ultimoConcurso);
                        
                        if (loadText) loadText.textContent = `Carregando 0/${concursoFinal}...`;
                        
                        // Busca cada concurso individualmente
                        for (let concurso = 1; concurso <= concursoFinal; concurso++) {
                            try {
                                // Atualiza progresso no bot√£o
                                if (loadText) loadText.textContent = `Carregando ${concurso}/${concursoFinal}...`;
                                
                                const response = await fetch(`https://servicebus2.caixa.gov.br/portaldeloterias/api/supersete/${concurso}`);
                                
                                if (response.ok) {
                                    const data = await response.json();
                                    if (data && data.listaDezenas) {
                                        allResults.push({
                                            numero: data.numero,
                                            dataApuracao: data.dataApuracao,
                                            listaDezenas: data.listaDezenas
                                        });
                                    }
                                }
                                
                                // Pequena pausa para n√£o sobrecarregar a API
                                if (concurso % 10 === 0) {
                                    await new Promise(resolve => setTimeout(resolve, 100));
                                }
                                
                            } catch (err) {
                                console.log(`Erro no concurso ${concurso}:`, err);
                            }
                        }
                        
                        console.log(`üéØ DADOS REAIS CARREGADOS: ${allResults.length}/${concursoFinal} concursos`);
                        
                    } else {
                        throw new Error(`API retornou erro: ${latestResponse.status}`);
                    }
                    
                } catch (apiError) {
                    console.error('‚ùå ERRO NA API:', apiError);
                    if (loadText) loadText.textContent = 'API falhou, gerando dados...';
                    
                    // Fallback: gera dados simulados com progresso
                    for (let i = 0; i < limit; i++) {
                        if (loadText) loadText.textContent = `Gerando ${i + 1}/${limit}...`;
                        
                        // Simula um pequeno delay para mostrar progresso
                        if (i % 100 === 0) {
                            await new Promise(resolve => setTimeout(resolve, 50));
                        }
                    }
                    
                    allResults = generateSampleData(limit);
                    console.log(`üîÑ DADOS SIMULADOS: ${allResults.length} concursos`);
                }
                
                // Se n√£o conseguiu dados suficientes da API, complementa
                if (allResults.length < limit) {
                    const missing = limit - allResults.length;
                    if (loadText) loadText.textContent = `Complementando ${missing} dados...`;
                    
                    const simulatedData = generateSampleData(missing, allResults.length + 1);
                    allResults = [...allResults, ...simulatedData];
                }
                
                // Finaliza o carregamento
                if (loadText) loadText.textContent = 'Processando dados...';
                
                // Ordena por n√∫mero do concurso
                allResults.sort((a, b) => a.numero - b.numero);
                
                renderResults();
                showResultsInfo();
                calculateStatistics();
                calculateColumnStats();
                
                console.log('‚úÖ Carregamento do Super Sete conclu√≠do com sucesso');
                
            } catch (error) {
                console.error('‚ùå Erro no carregamento:', error);
                showError('Erro ao carregar resultados: ' + error.message);
            } finally {
                isLoading = false;
                
                // Remove loading
                if (loadSpinner) loadSpinner.classList.add('hidden');
                if (loadText) loadText.textContent = 'Carregar Resultados';
                if (loadBtn) loadBtn.disabled = false;
            }
        }

        function renderResults() {
            console.log(`üé® Renderizando ${allResults.length} resultados do Super Sete`);
            
            const resultsDiv = document.getElementById('results');
            if (!resultsDiv) {
                console.error('‚ùå Elemento results n√£o encontrado');
                return;
            }
            
            if (allResults.length === 0) {
                console.log('‚ö†Ô∏è Nenhum resultado para renderizar');
                resultsDiv.innerHTML = '<p class="text-center text-gray-500">Nenhum resultado carregado</p>';
                return;
            }

            // Ordena√ß√£o
            const sortOrderSelect = document.getElementById('sortOrder');
            const sortOrder = sortOrderSelect ? sortOrderSelect.value : 'desc';
            
            const sortedResults = [...allResults].sort((a, b) => {
                return sortOrder === 'desc' ? b.numero - a.numero : a.numero - b.numero;
            });
            
            console.log(`üìä Ordena√ß√£o: ${sortOrder}, Primeiros 3: [${sortedResults.slice(0, 3).map(r => r.numero).join(', ')}]`);

            // Colunas
            const columnsSelect = document.getElementById('columns');
            const columnsCount = columnsSelect ? columnsSelect.value : '3';
            
            const gridCols = {
                '1': 'grid-cols-1',
                '2': 'grid-cols-1 md:grid-cols-2',
                '3': 'grid-cols-1 md:grid-cols-2 lg:grid-cols-3',
                '4': 'grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4',
                '5': 'grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5'
            };
            
            resultsDiv.className = `grid gap-4 ${gridCols[columnsCount]}`;

            // Criar cards
            const htmlCards = sortedResults.map(result => createResultCard(result));
            resultsDiv.innerHTML = htmlCards.join('');
            
            console.log(`‚úÖ ${htmlCards.length} cards renderizados no DOM`);
        }

        function createResultCard(result) {
            const showInfoCheckbox = document.getElementById('showInfo');
            const showInfo = showInfoCheckbox ? showInfoCheckbox.checked : true;
            
            const viewTypeSelect = document.getElementById('viewType');
            const viewType = viewTypeSelect ? viewTypeSelect.value : 'columns';
            
            const dezenas = result.listaDezenas;
            
            const headerHTML = showInfo ? `
                <div class="p-4 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-supersete-100 to-supersete-200 dark:from-supersete-950 dark:to-supersete-900">
                    <div class="flex justify-between items-center">
                        <div class="bg-supersete-300 dark:bg-supersete-800 px-3 py-1 rounded-lg">
                            <h3 class="font-semibold text-gray-900 dark:text-white">Concurso ${result.numero}</h3>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="bg-supersete-200 dark:bg-supersete-900 px-3 py-1 rounded-lg">
                                <p class="text-sm text-gray-700 dark:text-gray-300">${result.dataApuracao}</p>
                            </div>
                            <div class="bg-green-100 dark:bg-green-900 border border-green-300 dark:border-green-700 px-2 py-1 rounded-lg">
                                <p class="text-xs text-green-700 dark:text-green-300 font-medium">7 Colunas</p>
                            </div>
                        </div>
                    </div>
                </div>
            ` : '';

            const numbersHTML = createNumbersDisplay(dezenas, viewType);

            return `
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden">
                    ${headerHTML}
                    <div class="p-4">
                        ${numbersHTML}
                    </div>
                </div>
            `;
        }

        function createNumbersDisplay(dezenas, viewType) {
            switch (viewType) {
                case 'horizontal':
                    return `
                        <div class="flex flex-wrap gap-2 justify-center">
                            ${dezenas.map((num, index) => {
                                return `<div class="flex flex-col items-center gap-1">
                                    <span class="text-xs text-gray-500 dark:text-gray-400">Col ${index + 1}</span>
                                    <div class="w-10 h-10 bg-supersete-primary text-white rounded-lg flex items-center justify-center text-lg font-bold">${num}</div>
                                </div>`;
                            }).join('')}
                        </div>
                    `;

                case 'compact':
                    return `
                        <div class="text-center">
                            <div class="inline-flex gap-1 bg-gray-100 dark:bg-gray-700 p-2 rounded-lg">
                                ${dezenas.map(num => {
                                    return `<span class="inline-block bg-supersete-primary text-white px-3 py-2 rounded text-lg font-bold min-w-[40px] text-center">${num}</span>`;
                                }).join('')}
                            </div>
                        </div>
                    `;

                case 'table':
                    return `
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead>
                                    <tr>
                                        ${Array.from({length: 7}, (_, i) => `<th class="column-header text-center py-2 px-3 text-sm">Col ${i + 1}</th>`).join('')}
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        ${dezenas.map(num => `<td class="text-center py-3 px-3 bg-supersete-100 dark:bg-supersete-900 border border-supersete-200 dark:border-supersete-800"><span class="text-xl font-bold text-supersete-700 dark:text-supersete-300">${num}</span></td>`).join('')}
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    `;

                default: // columns
                    return `
                        <div class="grid grid-cols-7 gap-2">
                            ${Array.from({length: 7}, (_, colIndex) => {
                                const sortedNum = dezenas[colIndex];
                                return `
                                    <div class="flex flex-col">
                                        <div class="column-header text-center py-1 px-2 text-xs rounded-t">Col ${colIndex + 1}</div>
                                        <div class="border border-supersete-200 dark:border-supersete-700 rounded-b">
                                            ${Array.from({length: 10}, (_, numIndex) => {
                                                const isSelected = parseInt(sortedNum) === numIndex;
                                                const bgColor = isSelected ? 'bg-supersete-primary text-white' : 'bg-gray-50 dark:bg-gray-700 text-gray-600 dark:text-gray-400';
                                                return `<div class="number-ball w-full aspect-square flex items-center justify-center text-xs font-bold border-b border-gray-200 dark:border-gray-600 last:border-b-0 ${bgColor}">${numIndex}</div>`;
                                            }).join('')}
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    `;
            }
        }

        function showResultsInfo() {
            const resultsInfo = document.getElementById('resultsInfo');
            const loadedCount = document.getElementById('loadedCount');
            
            if (allResults.length > 0) {
                if (loadedCount) loadedCount.textContent = allResults.length;
                if (resultsInfo) resultsInfo.classList.remove('hidden');
            } else {
                if (resultsInfo) resultsInfo.classList.add('hidden');
            }
        }

        function calculateStatistics() {
            if (allResults.length === 0) {
                const statisticsDiv = document.getElementById('statistics');
                if (statisticsDiv) statisticsDiv.classList.add('hidden');
                return;
            }

            const columnStatsBody = document.getElementById('columnStats');
            if (!columnStatsBody) return;

            let statsHTML = '';
            
            // Para cada coluna (0-6)
            for (let col = 0; col < 7; col++) {
                const colData = columnStats[col];
                if (!colData) continue;
                
                // Encontra o n√∫mero mais frequente nesta coluna
                let mostFreq = 0;
                let maxCount = 0;
                
                for (let num = 0; num <= 9; num++) {
                    if (colData[num] > maxCount) {
                        maxCount = colData[num];
                        mostFreq = num;
                    }
                }
                
                const percentage = allResults.length > 0 ? ((maxCount / allResults.length) * 100).toFixed(1) : '0.0';
                
                statsHTML += `
                    <tr class="border-b border-gray-100 dark:border-gray-700">
                        <td class="py-1 flex items-center gap-1">
                            <div class="w-2 h-2 bg-supersete-${400 + (col * 100)} rounded-full"></div>
                            <span class="font-medium">Coluna ${col + 1}</span>
                        </td>
                        <td class="text-center py-1 font-mono text-lg font-bold text-supersete-primary">${mostFreq}</td>
                        <td class="text-center py-1 font-mono">${maxCount}</td>
                        <td class="text-center py-1 font-mono">${percentage}%</td>
                    </tr>
                `;
            }
            
            columnStatsBody.innerHTML = statsHTML;

            const statisticsDiv = document.getElementById('statistics');
            if (statisticsDiv) statisticsDiv.classList.remove('hidden');
        }

        function clearResults() {
            console.log('üóëÔ∏è Limpando resultados');
            allResults = [];
            columnStats = {};
            
            const resultsDiv = document.getElementById('results');
            const resultsInfo = document.getElementById('resultsInfo');
            const statistics = document.getElementById('statistics');
            const error = document.getElementById('error');
            
            if (resultsDiv) resultsDiv.innerHTML = '';
            if (resultsInfo) resultsInfo.classList.add('hidden');
            if (statistics) statistics.classList.add('hidden');
            if (error) error.classList.add('hidden');
        }

        function showError(message) {
            console.error('‚ùå Erro:', message);
            const errorDiv = document.getElementById('error');
            if (errorDiv) {
                errorDiv.textContent = message;
                errorDiv.classList.remove('hidden');
            }
        }

        function toggleInfo() {
            const showInfo = document.getElementById('showInfo');
            const toggleIcon = document.getElementById('toggleIcon');
            
            if (showInfo && toggleIcon) {
                showInfo.checked = !showInfo.checked;
                toggleIcon.textContent = showInfo.checked ? '‚àí' : '+';
                renderResults();
            }
        }

        // Event listeners
        function initEventListeners() {
            console.log('üîó Configurando event listeners do Super Sete');
            
            const loadBtn = document.getElementById('loadBtn');
            if (loadBtn) {
                loadBtn.addEventListener('click', () => {
                    console.log('üëÜ Bot√£o Carregar clicado');
                    loadResults();
                });
            }
            
            const viewType = document.getElementById('viewType');
            if (viewType) {
                viewType.addEventListener('change', () => {
                    console.log('üëÅÔ∏è Visualiza√ß√£o alterada');
                    renderResults();
                });
            }
            
            const sortOrder = document.getElementById('sortOrder');
            if (sortOrder) {
                sortOrder.addEventListener('change', () => {
                    console.log('üîÑ Ordem alterada');
                    renderResults();
                });
            }
            
            const columns = document.getElementById('columns');
            if (columns) {
                columns.addEventListener('change', () => {
                    console.log('üìä Colunas alteradas');
                    renderResults();
                });
            }
            
            const showInfo = document.getElementById('showInfo');
            if (showInfo) {
                showInfo.addEventListener('change', () => {
                    console.log('‚ÑπÔ∏è Info alterada');
                    renderResults();
                });
            }
            
            const limit = document.getElementById('limit');
            if (limit) {
                limit.addEventListener('change', () => {
                    console.log('üìä Limite alterado');
                    loadResults();
                });
            }
            
            const showInfoBtn = document.getElementById('showInfoBtn');
            if (showInfoBtn) {
                showInfoBtn.addEventListener('click', toggleInfo);
            }
            
            const clearResults = document.getElementById('clearResults');
            if (clearResults) {
                clearResults.addEventListener('click', () => {
                    console.log('üóëÔ∏è Limpar clicado');
                    clearResults();
                });
            }
            
            // Modal
            const helpBtn = document.getElementById('helpBtn');
            const closeModal = document.getElementById('closeModal');
            const closeModalFooter = document.getElementById('closeModalFooter');
            const helpModal = document.getElementById('helpModal');
            
            if (helpBtn && helpModal) {
                helpBtn.addEventListener('click', () => helpModal.classList.remove('hidden'));
            }
            
            if (closeModal && helpModal) {
                closeModal.addEventListener('click', () => helpModal.classList.add('hidden'));
            }
            
            if (closeModalFooter && helpModal) {
                closeModalFooter.addEventListener('click', () => helpModal.classList.add('hidden'));
            }
            
            if (helpModal) {
                helpModal.addEventListener('click', (e) => {
                    if (e.target.id === 'helpModal') {
                        helpModal.classList.add('hidden');
                    }
                });
            }
        }

        // Inicializa√ß√£o
        function init() {
            console.log('üé¨ Inicializando aplica√ß√£o Super Sete');
            
            try {
                initEventListeners();
                console.log('‚úÖ Event listeners configurados');
                
                // Carrega automaticamente
                console.log('üîÑ Carregando dados iniciais do Super Sete');
                loadResults();
                
            } catch (error) {
                console.error('‚ùå Erro na inicializa√ß√£o:', error);
                showError('Erro na inicializa√ß√£o: ' + error.message);
            }
        }

        // Inicializa quando DOM estiver pronto
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }

        console.log('‚úÖ Script Super Sete carregado completamente');
    </script>
</body>
</html>